<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>EpigenomeChef manual</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">



<h1 class="title toc-ignore">EpigenomeChef manual</h1>
<h4 class="date">23/08/31 23:17</h4>

</div>


<div id="概要" class="section level1">
<h1>概要</h1>
<p><img src="manual_figure/graphical_abstract2.png" id="id"
class="class" style="width:100.0%" /> <br><br></p>
<p>EpigenomeChefは、ChIP-seqやATAC-seqにより得たカバレッジデータ(.BigWig)及びピークコールデータ(.bed)を自動的に統計解析・可視化するウェブアプリです。<br>
単一のデータセットの解析だけでなく、複数のデータセットの結果を統合解析(エピゲノムデータの統合解析)することも可能です。<br>
ChIP-seq, ATAC-seq,
Bisulfite-seqのデータベースである<strong>ChIP-atlas</strong>からダウンロードしたデータをそのまま使用することができます(事前にファイル名を変更する必要があります。詳細はInput
fileの共通ルール・注意点)。
また、RNA-seqデータから得た遺伝子発現変動(DEG)解析結果を同時にアップロードすることで、トランスクリプトーム解析との統合解析も可能です。<br><br>
EpigenomeChefは、Docker imageをインストールすることで使用可能です。<br>
<strong>0.（Docker環境がない場合）Dockerのインストール</strong><br>
インストール方法は以下のページが詳しいです。<br> Windows:<a
href="https://sukkiri.jp/technologies/virtualizers/docker/docker-win_install.html">https://sukkiri.jp/technologies/virtualizers/docker/docker-win_install.html</a><br>
Mac:<a
href="https://matsuand.github.io/docs.docker.jp.onthefly/desktop/mac/install/">https://matsuand.github.io/docs.docker.jp.onthefly/desktop/mac/install/</a><br><br></p>
<p><strong>1.
EpigenomeChefのインストール</strong>（一度実行すれば以後必要ありません）
<br>
注意点：HOMERはリファレンスゲノムのファイルサイズが大きいため、リファレンス毎にdocker
imageを分割しています。解析したいデータセットの種に対応するdocker
imageをインストールしてください。<br> HOMER human (hg19)対応 (required
storage size: 18Gb)</p>
<pre><code>docker pull omicschef/epigenomechef:hg19v1.0.4-beta</code></pre>
<p>HOMER mouse (mm10)対応 (required storage size: 17Gb)</p>
<pre><code>docker pull omicschef/epigenomechef:mm10v1.0.4-beta</code></pre>
<p><strong>2. コンテナの作成</strong>（実行コマンドの入力）<br> HOMER
human (hg19)対応</p>
<pre><code>docker run --rm -p 3838:3838 omicschef/epigenomechef:hg19v1.0.4-beta</code></pre>
<p>HOMER mouse (mm10)対応</p>
<pre><code>docker run --rm -p 3838:3838 omicschef/epigenomechef:mm10v1.0.4-beta</code></pre>
<p><strong>ブラウザで<a
href="http://localhost:3838">http://localhost:3838</a>を立ち上げる</strong>。<br>
解析終了後はコンテナを削除してください。<br></p>
<p>If you need help, please create an issue on <a
href="https://github.com/Kan-E/EpigenomeChef/issues">Github</a> or <a
href="mailto:kaneto@kumamoto-u.ac.jp" class="email">contact us</a>.
<br></p>
<p>本アプリは以下のセクションにより構成されます。<br></p>
<ul>
<li><p><strong>Pair-wise</strong> (２群間比較のdifferential accessible
region解析)</p></li>
<li><p><strong>Venn diagram</strong>
(ゲノム領域の位置情報の重ね合わせの解析)</p></li>
<li><p><strong>Clustering</strong> (クラスタリング解析、k-means
clusteringを用いたゲノム領域の分類・解析)</p></li>
<li><p><strong>Enrichment viewer</strong>
(ゲノム領域の機能解析・モチーフ解析)</p></li>
<li><p><strong>More</strong>（その他の便利機能やReferenceなど）</p></li>
</ul>
<p>アプリはメニュー、セッティングパネル、アウトプットパネルの3種類のパネルで構成されています。<br>
各セクションはアプリ上部のメニューボタンをクリックすることで移動できます。<br>
解析を実行するファイルは、セッティングパネルからアップロードすることができます。<br>
解析は、アウトプットパネルのタブパネルをクリックすることで実行されます。<br><br>
<img src="manual_figure/panel.png" id="id" class="class"
style="width:90.0%" alt="panel" /> <br></p>
<hr />
</div>
<div id="input-fileの共通ルール注意点" class="section level1">
<h1>Input fileの共通ルール・注意点</h1>
<div id="拡張子" class="section level4">
<h4>拡張子</h4>
<p>カバレッジデータはBigWig file (.BigWig or .bw)、またはBam file
(.bam)が利用可能です。 ピークコールデータはnarrowPeak file
(.narrowPeak)、またはbed file (.bed)が利用可能です。 RNA-seq DEG result
fileはタブ区切りtxt file (.txt)、カンマ区切りcsv file
(.csv)、エクセルファイル (.xlsx)が利用可能です。<br><br></p>
</div>
<div id="bigwig-fileの形式" class="section level4">
<h4>BigWig fileの形式</h4>
<p>NormalizeされたBigWig file (例: Reads per million
(RPM))を使用してください。</p>
</div>
<div id="bigwig-fileおよびbam-fileのファイル名" class="section level4">
<h4>BigWig fileおよびBam fileのファイル名</h4>
<p>ファイル名はFigure中のサンプル名として使用されます。<br>
ハイフン”-“、スラッシュ”/“、コロン”:“、スペース”
“はファイル名に含めないでください。<br>
長すぎるファイル名はFigure作成に悪影響を及ぼすため、シンプルなファイル名を推奨します。<br>
サンプル名のn数（replicate number）は、アンダーバー「 _
」を用いて表記してください。<br> アンダーバー「 _
」は、n数の表記以外では使用できません。<br></p>
</div>
<div id="peak-call-fileおよびbed-fileのファイル名"
class="section level4">
<h4>Peak call fileおよびBed fileのファイル名</h4>
<ul>
<li><p><strong>Pair-wise DAR、Clustering</strong><br>
サンプル名のn数（replicate number）は、アンダーバー「 _
」を用いて表記してください。<br> アンダーバー「 _
」は、n数の表記以外では使用できません。<br></p></li>
<li><p><strong>Venn diagram、Enrichment viewer、Bedtools</strong><br>
ファイル名はFigure中のサンプル名として使用されます。<br>
長すぎるファイル名はFigure作成に悪影響を及ぼすため、シンプルなファイル名を推奨します。<br></p></li>
</ul>
</div>
<div id="同時アップロードの注意点" class="section level4">
<h4>同時アップロードの注意点</h4>
<p>異なるフォルダに含まれるファイルは同時にアップロードできません。<br>
同時にアップロードしたいファイルは、同一のフォルダにまとめてください。<br></p>
<hr />
</div>
</div>
<div id="output-fileの共通ルール注意点" class="section level1">
<h1>Output fileの共通ルール・注意点</h1>
<div id="データの保存" class="section level4">
<h4>データの保存</h4>
<p>ダウンロードボタンを押すことで、テーブルデータやグラフが保存されます。<br>
表データはタブ区切りtxt
file(.txt)、グラフはイラストレーターで編集可能なPDFファイルで保存されます。<br>
<strong>HOMER
report</strong>のみ、zip形式で複数のファイルが保存されます。<br><br></p>
</div>
<div id="保存されるグラフのサイズ調整" class="section level4">
<h4>保存されるグラフのサイズ調整</h4>
<p>Setting panelの「Output plot size setting for
pdf」を調整することで保存される図のサイズを変更できます。<br>
グラフ内で隣り合う文字が重なってしまう場合やグラフの余白が大きすぎる場合にパラメーターを調整して下さい。<br>
パラメーターの値が0の場合、デフォルトサイズで保存されます。<br>
デフォルトサイズは、図の種類によって異なります。詳細は、アプリ内のポップアップからご覧ください。<br><br></p>
<hr />
</div>
</div>
<div id="pair-wise-dar" class="section level1">
<h1>Pair-wise DAR</h1>
<p>２群間の比較解析を実行します。DAR（Differential accessible
region）の同定・可視化・機能解析結果を出力します。</p>
<div id="setting" class="section level2">
<h2>Setting</h2>
<p><img src="manual_figure/pair-wise%20set.png" id="id" class="class"
style="width:100.0%" /><br></p>
<hr />
<div id="input-format" class="section level3">
<h3>Input format</h3>
<p>重要な選択肢は以下の２点です。<br></p>
<ul>
<li><strong>input</strong>: BigWig fileまたはBam fileの選択</li>
<li><strong>Genomic region</strong>:
Genome-wideまたはPromoterの選択</li>
</ul>
<div id="input" class="section level4">
<h4>Input</h4>
<ul>
<li><strong>BigWig fileを選ぶ場合</strong><br> BigWig
fileは必ずnormalizedされたデータを使用してください(例：RPM)。<br>
二群間の統計解析はNormalized count
dataの解析が可能なLimmaを実行します。<br></li>
<li><strong>Bam fileを選ぶ場合</strong><br> Sequence情報（single-end or
paired-end）が必要となります。<br>
二群間の統計解析はDESeq2を実行します。<br>
各サンプルのリード数が揃っている場合は、BigWig
fileを用いた解析より精度の高い結果が得られます。しかし、各サンプルのリード数が大きく異なる場合は、解析に大きな誤差が生じることがあります。<br></li>
<li><strong>Count file + BigWig fileを選ぶ場合</strong><br>
過去にPair-wise
DARによる解析を実行し、カウントファイルを得ている場合のみ使用できます。<br>
このモードを用いることで、BigWigファイルからカウントデータを抽出するステップを省略することができます。<br>
<strong>Type</strong>:カウントファイルを作成した条件によって変更してください。BigWigファイルをインプットとした場合は<strong>Normalized
count</strong>、Bamファイルをインプットとした場合は<strong>Raw
count</strong>を選択してください。 <strong>Genomic
region</strong>や<strong>Filter</strong>は過去の解析の条件と合わせてください。
peak
patternやトラックプロットを書きたい場合は、BigWigファイルもアップロードする必要があります。</li>
</ul>
</div>
<div id="genomic-region" class="section level4">
<h4>Genomic region</h4>
<ul>
<li><p><strong>Genome-wideを選ぶ場合</strong><br> Peak call
fileのアップロードが必要となります。<br>
アップロードしたBigWigファイルに対応する全てのpeak call
fileをアップロードしてください。<br>
再現性のあるピーク領域に絞りこんで解析するために、２ファイル以上で共通してピークコールされた領域のみを参照・カウント化します。<br></p></li>
<li><p><strong>Filter</strong><br> Reproducible peaks:
各条件に関して再現性のあるピークコール領域のみを抽出します（最低 n =
2でピークコールされる領域）。<br> （例1：A_1 有、A_2 有、B_1 無、B_2 無
→ reproducible、例2：A_1 無、A_2 無、B_1 有、B_2 有 →
reproducible、例2：A_1 有、A_2 無、B_1 無、B_2 有 → NOT reproducible）
ALL peaks: ピークコールされた全ての領域をカウント化します。</p></li>
<li><p><strong>Promoterを選ぶ場合</strong><br> Peak call
fileのアップロードは不要となります。<br>
Promoter領域の範囲は自由に変更可能です（default: upstream = 500 bp,
downstream = 500 bp）。<br>
Speciesの選択が必須となります。<br><br></p></li>
</ul>
<p>なお、アップロードするファイル名は<strong>Input
fileの共通ルール・注意点</strong>に記載されたルールをお守りください。<br></p>
<hr />
</div>
<div id="species" class="section level4">
<h4>Species</h4>
<p>適切な種（リファレンス）を選択することで以下の解析が実行されます。</p>
<ul>
<li>Promoter領域の解析</li>
<li>トラックプロット、peak distribution、GREAT, HOMER, with RNAseqの実行
<br></li>
</ul>
</div>
<div id="cut-off-conditions" class="section level4">
<h4>Cut-off conditions</h4>
<p>Fold change, FDRの閾値が設定できます。 <br> <br></p>
<hr />
</div>
</div>
</div>
<div id="output" class="section level2">
<h2>Output</h2>
<div id="input-data" class="section level3">
<h3>Input Data</h3>
<p>アップロードしたファイル名を表示します。<br>
カウントデータ作成後、カウントデータを表示します。 <br><br> -
<strong>Sample order</strong><br>
BigWigファイルの順番を並び替えることができます。<br>
※ドラッグ&amp;ドロップはできません。テキストを消すようにdeleteボタンで削除し、解析したい順番になるように再入力してください。
<img src="manual_figure/pair-wise%20input.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
<hr />
</div>
<div id="result-overview" class="section level3">
<h3>Result overview</h3>
<div id="clustering-analysis-volcano-plot-heatmap"
class="section level4">
<h4>Clustering analysis, volcano plot, heatmap</h4>
<p>Principal Component Analysis (PCA)、Multi-Dimensional Scaling (MDS),
ward.D2による階層的クラスタリングの3種類のクラスタリング解析を実行します。
<br><br> <img src="manual_figure/pair-wise%20pca.png" id="id"
class="class" style="width:90.0%" /><br><br> DAR解析の結果をvolcano
plotとheatmapで表示します。<br> <strong>DAR
resultテーブル</strong>の項目をクリックすると、volcano
plotで表示される点のうち、選択した領域だけを緑色で表示します。<br></p>
</div>
<div id="trackplotパネル" class="section level4">
<h4>Trackplotパネル</h4>
<p><strong>DAR
resultテーブル</strong>の項目をクリックすると、選択した領域及びその近傍遺伝子のトラックプロットを表示します。<br>
トラックプロットのハイライト（赤）は、選択した領域を示しています。<br>
トラックプロットのピークの高さは、<strong>peak
range</strong>で変更可能です。<br>
トラックプロットに追加のデータを表示したい場合には、<strong>select
additional bigwig files</strong>からデータをアップロードしてください。
<img src="manual_figure/pair-wise%20overview.png" id="id" class="class"
style="width:90.0%" /><br><br>
volcanoプロット中の興味あるゲノム領域を囲うことで、そのゲノム領域の情報だけを抜き出したテーブルデータを表示することもできます。
<img src="manual_figure/pair-wise%20overview2.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
</div>
<div id="up_peaks及びdown_peaksパネル" class="section level4">
<h4>Up_peaks及びDown_peaksパネル</h4>
<p>表データとして、DAR (bed file)が出力されます。<br>
ダウンロードしたbed fileは<strong>Venn
diagram</strong>や<strong>Clustering</strong>、<strong>Enrichment
viewer</strong>セクションにそのままアップロード・再解析が可能です。<br><br>
<br><br></p>
<hr />
</div>
</div>
<div id="peak-distribution" class="section level3">
<h3>Peak distribution</h3>
<p>Up及びDownしたDARのannotation情報を円グラフとして出力します。<br>
円グラフは次の3種類のレベルで表示されます。<br></p>
<ul>
<li><p><strong>Gene Level</strong><br> Promoter, Downstream, Gene body,
Distal intergenic<br></p></li>
<li><p><strong>Exon/Intron/Intergenic</strong><br> Exon, Intron,
Intergenic<br></p></li>
<li><p><strong>Exon Level</strong><br> 5’ UTR, 3’ UTR, CDS, Other
exon<br><br> <img src="manual_figure/pair-wise%20distribution.png"
id="id" class="class" style="width:90.0%" /><br><br></p></li>
</ul>
<hr />
</div>
<div id="peak-pattern" class="section level3">
<h3>Peak pattern</h3>
<p>Peak heatmap (Peakの頂点を中心にDARを並べたheatmapで表示)とline plot
(各サンプルのDARにおけるピークの平均値をline
plotで表示)を出力します。<br>
追加のデータを表示したい場合には、<strong>select additional bigwig
files</strong>からデータをアップロードしてください。<br><br> <img
src="manual_figure/pair-wise%20pattern.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
<hr />
</div>
<div id="great" class="section level3">
<h3>GREAT</h3>
<p>GREAT (Genomic Regions Enrichment of Annotations
Tool)をベースとしたエンリッチメント解析によりDARの機能を同定します。<br>
解析に使用できる遺伝子セットは、以下の通りです。<br> <a
href="http://www.gsea-msigdb.org/gsea/msigdb/genesets.jsp?collection=H">MSigDB
hallmark gene</a> <br> <a href="https://www.kegg.jp">KEGG</a> <br> <a
href="https://reactome.org">Reactome</a> <br> <a
href="https://maayanlab.cloud/Harmonizome/resource/Pathway+Interaction+Database">PID
(Pathway Interaction Database)</a> <br> <a
href="https://maayanlab.cloud/Harmonizome/dataset/Biocarta+Pathways">BioCarta</a>
<br> <a
href="https://www.wikipathways.org/index.php/WikiPathways">WikiPathways</a>
<br> <a href="http://geneontology.org">GO (biological process, cellular
component, and molecular function)</a> <br> <a
href="https://hpo.jax.org/app/">Human phenotype ontology</a> <br> <a
href="https://saezlab.github.io/dorothea/">DoRothEA regulon
(activator)</a> <br> <a
href="https://saezlab.github.io/dorothea/">DoRothEA regulon
(repressor)</a> <br> <a
href="http://www.gsea-msigdb.org/gsea/msigdb/genesets.jsp?collection=TFT">Transcription
factor targets</a> <br> <a
href="http://www.gsea-msigdb.org/gsea/msigdb/genesets.jsp?collection=MIR">miRNA
target</a> <br> 注) 転写因子の予測解析は<strong>DoRothEA
regulon</strong>の使用を推奨します。<br><br></p>
<p>解析は、<a
href="https://bioconductor.org/packages/release/bioc/vignettes/rGREAT/inst/doc/local-GREAT.html">rGREAT</a>に依存します。<br><br>
<img src="manual_figure/pair-wise%20great.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
<hr />
</div>
<div id="homer" class="section level3">
<h3>HOMER</h3>
<p>HOMER (Hypergeometric Optimization of Motif
EnRichment)をベースとしたエンリッチメント解析により、DARに含まれるDNA結合モチーフを同定します。<br></p>
<div id="type-of-enrichment-analysis" class="section level4">
<h4>Type of enrichment analysis</h4>
<p>“known motif”: known motifのみ解析します。<br> “known + unknown
motif”: known motifに加えてunknown motifの解析も行います。<br></p>
</div>
<div id="type-of-the-region-for-motif-finding" class="section level4">
<h4>Type of the region for motif finding</h4>
<p>“given (exact size)”:
各ピークの全領域を解析します。修飾ヒストンのようなbroadなpeakの解析に有効です。<br>
“custom size”: ピークの中央から指定したサイズ(default:
200)に絞って解析します。ATAC-seqやDNA結合タンパク質の解析に有効です。<br></p>
</div>
<div id="background-sequence" class="section level4">
<h4>Background sequence</h4>
<p>“ramdom”:ゲノム領域からランダムにbackground
sequenceを抽出します。<br> “peak calling
files”:解析対象を除いたピーク領域をbackgroundとして利用します（例：up
DARを解析する際はNS regionとdown
DARをbackgroundとして利用）。randomと比べてよりspecificなmotifが予測できる可能性があります。</p>
</div>
<div id="download-homer-report" class="section level4">
<h4>Download homer report</h4>
<p>HOMERの実行結果がzip形式で一括downloadできます。<br><br> <img
src="manual_figure/pair-wise%20motif.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
<hr />
</div>
</div>
<div id="with-rnaseq" class="section level3">
<h3>with RNAseq</h3>
<p>RNA-seqのDEG result
fileをアップロードすることで、DAR(epigenome)とDEG(transcriptome)の統合解析ができます。<br>
RNA-seqのDEG result fileのフォーマットは以下の通りです。</p>
<ul>
<li>拡張子は、タブ区切りtxt、カンマ区切りcsv、エクセルxlsxのいずれか</li>
<li>1行目はgene symbolまたはENSEMBL ID</li>
<li>カラム名が「log2FoldChange」及び「padj」の列を含む</li>
</ul>
<p>上記の条件を満たせば、bulk
RNA-seqまたはscRNA-seqのデータが使用できます。<br>
<strong>注意点</strong>: Log2FoldChangeは「A vs
B」の場合、Log2(A/B)で計算されるため、Upは負の値となります。RNAseqChef以外で取得したDEG
resultファイルを利用される場合は、正負の値に注意して下さい。<br><br>
<img src="manual_figure/pair-wise%20DEG.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
<div id="regulatory-potential-rpをベースとした解析について"
class="section level4">
<h4>Regulatory Potential (RP)をベースとした解析について</h4>
<p>Epigenome(DAR)の解析結果では以下のようなケースがあります。<br>
１遺伝子に対して</p>
<ul>
<li>複数のDARが近傍に局在</li>
<li>upとdownの両方のDARが局在</li>
</ul>
<p>遺伝子発現とエピゲノム情報を統合解析するためには、まずは上記のような１遺伝子対して複数存在するエピゲノム情報を統合し、一つのスコアにまとめる必要があります。<br>
本アプリでは、エピゲノム情報を一つのスコアにまとめるために<strong>Regulatory
Potential (RP)</strong>の理論を採用しています。<br>
RPスコアはピークの位置がTSSに近いほど高く、TSSから離れるほど低くなるように計算されます。
RPスコアに反映されるTSSからのピークの最大距離は100kb（<strong>Regulatory
range (distance (kb) from TSS)</strong>より変更可能）です。
RNAseqのDEGのcutoffは、<strong>Fold change cutoff for RNA-seq
data</strong>及び<strong>FDR cutoff for RNA-seq
data</strong>より設定できます（defaultはfold change = 1.5, fdr =
0.05）。</p>
</div>
<div id="boxplot" class="section level4">
<h4>Boxplot</h4>
<p>RPの値を指標に遺伝子を分類し、各グループのlog2FoldChangeの値をプロットします。<br>
RPの分類はRPが１より大きい遺伝子(RP &gt; 1)、RPが１より小さい遺伝子(RP
&lt; -1)、その他(Others)です。<br> 統計解析はTukeyHSDを実行します。*
p&lt;0.05, ** p&lt;0.01, *** p&lt;0.001<br>
着目するEpigenome変化がどの程度遺伝子発現変動に寄与するかがわかります。<br><br>
<img src="manual_figure/pair-wise%20boxplot.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
</div>
<div id="barplot" class="section level4">
<h4>Barplot</h4>
<p>DEGのうち、RPが0以上(または0以下)の遺伝子がどの程度存在するかを積み上げ棒グラフで表示する。<br>
また逆に、RPが0以上(または0以下)の遺伝子のうち、DEGがどの程度存在するかを表示する。<br></p>
</div>
<div id="ks-plot" class="section level4">
<h4>KS plot</h4>
<p>RPスコアが高い順に遺伝子を並べて、３つのグループの（遺伝子発現が増加した遺伝子(up)、減少した遺伝子(down)、有意差が見られなかった遺伝子(NS)）の分布を比較します。<br>
例えば、RPスコアが高いほど遺伝子発現が増加する傾向にある場合、赤色で示すupの線は灰色で示すNSの線より左側で立ち上がります。<br>
Kolmogorov-Smirnov testsにより有意差検定をします。<br>
着目するEpigenome変化（RPスコア）と遺伝子発現変動の相関関係がわかります。<br><br>
<img src="manual_figure/pair-wise%20barplot.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
</div>
<div id="result-tableパネル" class="section level4">
<h4>Result tableパネル</h4>
<p>TranscriptomeとEpigenomeの情報をリンクさせた分類結果を出力します。
例えば、「RNA及びEpigenomeが共にupした遺伝子」や「RNA及びEpigenomeが共にdownした遺伝子」など(<strong>Group(RNA-Epigenome)</strong>より選択可能)の情報をテーブルデータとして出力します。<br>
各グループに対応するDARは、bed形式でダウンロードすることも可能です。<br>
ダウンロードしたbed fileは<strong>Venn
diagram</strong>や<strong>Clustering</strong>、<strong>Enrichment
viewer</strong>セクションにそのままアップロード・再解析が可能です。<br>
興味ある項目をクリックすると、<strong>Trackplotパネル</strong>に選択したDAR及び近傍遺伝子のトラックプロットが出力されます。<br><br>
<img src="manual_figure/pair-wise%20rnaseqtrackplot.png" id="id"
class="class" style="width:90.0%" /><br><br></p>
</div>
<div id="functional-enrichment-analysisパネル" class="section level4">
<h4>Functional enrichment analysisパネル</h4>
<p>興味あるグループを選択すると、エンリッチメント解析を実行します。<br>
このエンリッチメント解析は、RNA-seq解析におけるエンリッチメント解析方法を使用します（GREATをベースとしたエンリッチメント解析とは異なります）。
解析は、<a
href="https://yulab-smu.top/biomedical-knowledge-mining-book/enrichplot.html">ClusterProfiler</a>に依存します。<br><br>
<img src="manual_figure/pair-wise%20rnaseqenrich.png" id="id"
class="class" style="width:90.0%" /><br><br></p>
<hr />
</div>
</div>
<div id="combined-heatmap" class="section level3">
<h3>Combined Heatmap</h3>
<p>UpおよびDownしたPeakに対応するRNAseqのカウントデータやFoldChange、ChIP-seqやATAC-seqのPeakパターンをHeatmapで同時に可視化します。<br>
STARTボタンを押すと、解析を実行します。<br><br> <img
src="manual_figure/pair-wise%20comb.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
<hr />
</div>
</div>
</div>
<div id="venn-diagram" class="section level1">
<h1>Venn diagram</h1>
<p>Venn
diagramにより共通・非共通のゲノム領域を同定します。ベン図の各領域のアノテーション・可視化・機能解析結果を出力します。</p>
<div id="setting-1" class="section level2">
<h2>Setting</h2>
<p><img src="manual_figure/venn%20setting.png" id="id" class="class"
style="width:50.0%" alt="venn diagram set" /><br></p>
<hr />
<div id="input-format-1" class="section level3">
<h3>Input format</h3>
<div id="input-1" class="section level4">
<h4>Input</h4>
<ul>
<li><strong>Bed files</strong><br> Venn
diagram解析において必ず必要となるファイルです。<br>
ファイル名はFigure中のサンプル名として使用されます。<br>
長すぎるファイル名はFigure作成に悪影響を及ぼすため、シンプルなファイル名を推奨します。<br>
<strong>最大アップロード数は5ファイル</strong>です。</li>
<li><strong>BigWig files</strong><br> Trackplotやpeak pattern (peak
heatmapやline plot)を出力する場合は必要となります。<br>
その他の機能においてはアップロードは不要です。</li>
<li><strong>Sample order</strong><br>
BigWigファイルの順番を並び替えることができます。<br>
※ドラッグ&amp;ドロップはできません。テキストを消すようにdeleteボタンで削除し、解析したい順番になるように再入力してください。</li>
</ul>
<hr />
</div>
<div id="species-1" class="section level4">
<h4>Species</h4>
<p>適切な種（リファレンス）を選択することで以下の解析が実行されます。</p>
<ul>
<li>トラックプロット、peak distribution、GREAT, HOMER, with RNAseqの実行
<br></li>
</ul>
<hr />
</div>
</div>
</div>
<div id="output-1" class="section level2">
<h2>Output</h2>
<div id="venn-diagram-1" class="section level3">
<h3>Venn diagram</h3>
<p>アップロードしたbed fileのoverlap領域を同定します。<br>
結果として、Venn diagramを出力します。<br>
また、Bigwigファイルをアップロードした場合、各intersectのピークパターンがラインプロットで表示されます。
<br><br> <img src="manual_figure/venn%20venn.png" id="id" class="class"
style="width:90.0%" alt="venn input" /><br><br> #### Lineplot of
intersections (comparison between intersections)
アップロードしたそれぞれのBigWigファイルに関して得られたintersection部分の平均値をプロットします。<br>
一つのBigWigファイル内におけるintersection部分のピークの高さを比較できます。<br></p>
<div id="lineplot-of-intersections-comparison-between-bigwig"
class="section level4">
<h4>Lineplot of intersections (comparison between bigwig)</h4>
<p>アップロードした全てのbigwigファイルに関してintersection部分のピークの高さを比較できます。<br><br></p>
<p><img src="manual_figure/venn%20lineplot.png" id="id" class="class"
style="width:90.0%" alt="venn input" /><br><br></p>
<hr />
</div>
</div>
<div id="peak-pattern-1" class="section level3">
<h3>Peak pattern</h3>
<p><strong>Select intersect</strong>から選択したvenn図の領域に関してPeak
patternを分析します。<br>
intersectのハイフン”-“はoverlapを意味します。。<br>
例：A.bedとB.bedの解析の場合。<br> A: Bと重複しないAの領域<br> B:
Aと重複しないBの領域<br> A-B: AとBのoverlap領域<br></p>
<div id="peak-heatmapとline-plot" class="section level4">
<h4>Peak heatmapとline plot</h4>
<p>BigWig fileをアップロードした場合、表示されます。<br>
選択した領域に関して中央から前後2000kbの領域をheatmap及びline
plotとして出力します。<br>
さらに追加のデータを表示したい場合には、<strong>select additional bigwig
files</strong>からデータをアップロードしてください。<br></p>
</div>
<div id="peak-distribution-1" class="section level4">
<h4>Peak distribution</h4>
<p>Speciesを選択した場合、表示されます。<br>
選択した領域のannotation情報を円グラフとして出力します。<br>
円グラフは次の3種類のレベルで表示されます。</p>
<ul>
<li><p><strong>Gene Level</strong><br> Promoter, Downstream, Gene body,
Distal intergenic<br></p></li>
<li><p><strong>Exon/Intron/Intergenic</strong><br> Exon, Intron,
Intergenic<br></p></li>
<li><p><strong>Exon Level</strong><br> 5’ UTR, 3’ UTR, CDS, Other
exon<br><br> <img src="manual_figure/venn%20pattern.png" id="id"
class="class" style="width:90.0%" alt="venn input" /><br><br></p></li>
</ul>
</div>
<div id="trackplotパネル-1" class="section level4">
<h4>Trackplotパネル</h4>
<p><strong>selected intersect
dataパネル</strong>の項目をクリックすると、選択した項目のトラックプロットを表示します。<br>
トラックプロットのハイライト（赤）は、選択した領域を示しています。<br>
トラックプロットのピークの高さは、<strong>peak
range</strong>で変更可能です。<br>
トラックプロットに追加のデータを表示したい場合には、<strong>select
additional bigwig
files</strong>からデータをアップロードしてください。<br><br> <img
src="manual_figure/venn%20trackplot.png" id="id" class="class"
style="width:90.0%" alt="venn input" /><br><br></p>
</div>
<div id="selected-intersect-dataパネル" class="section level4">
<h4>selected intersect dataパネル</h4>
<p>選択した領域の情報が表データとして出力されます。<br>
近傍の遺伝子やannotation情報をtxt fileとしてダウンロード可能です。<br>
また、bed形式としてもダウンロード可能です。ダンロードしたbedファイルは<strong>Clustering</strong>、<strong>Enrichment
viewer</strong>セクションのインプットとしてアップロード・再解析が可能です。<br><br></p>
<hr />
</div>
</div>
<div id="great-1" class="section level3">
<h3>GREAT</h3>
<p>GREAT (Genomic Regions Enrichment of Annotations
Tool)をベースとしたエンリッチメント解析により、<strong>Select
intersect</strong>から選択したvenn図の領域の機能を同定します。<br>
解析に使用できる遺伝子セットは、以下の通りです。<br> <a
href="http://www.gsea-msigdb.org/gsea/msigdb/genesets.jsp?collection=H">MSigDB
hallmark gene</a> <br> <a href="https://www.kegg.jp">KEGG</a> <br> <a
href="https://reactome.org">Reactome</a> <br> <a
href="https://maayanlab.cloud/Harmonizome/resource/Pathway+Interaction+Database">PID
(Pathway Interaction Database)</a> <br> <a
href="https://maayanlab.cloud/Harmonizome/dataset/Biocarta+Pathways">BioCarta</a>
<br> <a
href="https://www.wikipathways.org/index.php/WikiPathways">WikiPathways</a>
<br> <a href="http://geneontology.org">GO (biological process, cellular
component, and molecular function)</a> <br> <a
href="https://hpo.jax.org/app/">Human phenotype ontology</a> <br> <a
href="https://saezlab.github.io/dorothea/">DoRothEA regulon
(activator)</a> <br> <a
href="https://saezlab.github.io/dorothea/">DoRothEA regulon
(repressor)</a> <br> <a
href="http://www.gsea-msigdb.org/gsea/msigdb/genesets.jsp?collection=TFT">Transcription
factor targets</a> <br> <a
href="http://www.gsea-msigdb.org/gsea/msigdb/genesets.jsp?collection=MIR">miRNA
target</a> <br> 注) 転写因子の予測解析は<strong>DoRothEA
regulon</strong>の使用を推奨します。<br><br></p>
<p>解析は、<a
href="https://bioconductor.org/packages/release/bioc/vignettes/rGREAT/inst/doc/local-GREAT.html">rGREAT</a>に依存します。<br><br>
<img src="manual_figure/venn%20great.png" id="id" class="class"
style="width:90.0%" alt="venn input" /><br><br></p>
<hr />
</div>
<div id="homer-1" class="section level3">
<h3>HOMER</h3>
<p>HOMER (Hypergeometric Optimization of Motif
EnRichment)をベースとしたエンリッチメント解析により、<strong>Select
intersect</strong>から選択したvenn図の領域に含まれるDNA結合モチーフを同定します。<br></p>
<div id="type-of-enrichment-analysis-1" class="section level4">
<h4>Type of enrichment analysis</h4>
<p>“known motif”: known motifのみ解析します。<br> “known + unknown
motif”: known motifに加えてunknown motifの解析も行います。<br></p>
</div>
<div id="type-of-the-region-for-motif-finding-1" class="section level4">
<h4>Type of the region for motif finding</h4>
<p>“given (exact size)”:
各ピークの全領域を解析します。修飾ヒストンのようなbroadなpeakの解析に有効です。<br>
“custom size”: ピークの中央から指定したサイズ(default:
200)に絞って解析します。ATAC-seqやDNA結合タンパク質の解析に有効です。<br></p>
</div>
<div id="background-sequence-1" class="section level4">
<h4>Background sequence</h4>
<p>“ramdom”:ゲノム領域からランダムにbackground
sequenceを抽出します。<br> “bed files”: Background
file(bed形式)をアップロードするためのウィンドウが出現します。 複数のbed
filesをアップロードした場合は、mergeしたファイルをbackground
fileとして利用します。
backgroundファイルのうち、解析対象を除いた領域をbackgroundとして利用します。<br>
randomと比べてよりspecificなmotifが予測できる可能性があります。</p>
</div>
<div id="download-homer-report-1" class="section level4">
<h4>Download homer report</h4>
<p>HOMERの実行結果がzip形式で一括downloadできます。<br><br> <img
src="manual_figure/venn%20motif.png" id="id" class="class"
style="width:90.0%" alt="venn input" /><br><br></p>
<hr />
</div>
</div>
<div id="with-rnaseq-1" class="section level3">
<h3>with RNAseq</h3>
<p>RNA-seqのDEG(発現変動遺伝子) result
fileをアップロードすることで、<strong>Select
intersect</strong>から選択したvenn図の領域(epigenome)とDEG(transcriptome)の統合解析ができます。<br>
RNA-seqのDEG result fileのフォーマットは以下の通りです。</p>
<ul>
<li>拡張子は、タブ区切りtxt、カンマ区切りcsv、エクセルxlsxのいずれか</li>
<li>1行目はgene symbolまたはENSEMBL ID</li>
<li>カラム名が「log2FoldChange」及び「padj」の列を含む</li>
</ul>
<p>上記の条件を満たせば、bulk
RNA-seqまたはscRNA-seqのデータが使用できます。<br><br> <img
src="manual_figure/pair-wise%20DEG.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
<div id="regulatory-potential-rpをベースとした解析について-1"
class="section level4">
<h4>Regulatory Potential (RP)をベースとした解析について</h4>
<p>Epigenomeの解析結果では、一つの遺伝子に対して複数のピークがassociateするケースがあります。<br>
遺伝子発現とエピゲノム情報を統合解析するためには、まずは上記のような１遺伝子対して複数存在するエピゲノム情報を統合し、一つのスコアにまとめる必要があります。<br>
本アプリでは、エピゲノム情報を一つのスコアにまとめるために<strong>Regulatory
Potential (RP)</strong>の理論を採用しています。<br>
RPスコアはピークの位置がTSSに近いほど高く、TSSから離れるほど低くなるように計算されます。
RPスコアに反映されるTSSからのピークの最大距離は100kb（<strong>Regulatory
range (distance (kb) from TSS)</strong>より変更可能）です。
RNAseqのDEGのcutoffは、<strong>Fold change cutoff for RNA-seq
data</strong>及び<strong>FDR cutoff for RNA-seq
data</strong>より設定できます（defaultはfold change = 1.5, fdr =
0.05）。</p>
</div>
<div id="boxplot-1" class="section level4">
<h4>Boxplot</h4>
<p>RPの値を指標に遺伝子を分類し、各グループのlog2FoldChangeの値をプロットします。<br>
RPの分類はRPが１より大きい遺伝子(RP &gt; 1)、その他(Others)です。<br>
統計解析はWelch’s t-testを実行します。* p&lt;0.05, ** p&lt;0.01, ***
p&lt;0.001<br>
着目するゲノム領域がどの程度遺伝子発現変動に寄与するかがわかります。<br><br>
<img src="manual_figure/venn%20boxplot.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
</div>
<div id="barplot-1" class="section level4">
<h4>Barplot</h4>
<p>DEGのうち、RPが0以上の遺伝子がどの程度存在するかを積み上げ棒グラフで表示する。<br>
また逆に、RPが0以上の遺伝子のうち、DEGがどの程度存在するかを表示する。<br><br></p>
</div>
<div id="ks-plot-1" class="section level4">
<h4>KS plot</h4>
<p>RPスコアが高い順に遺伝子を並べて、２つのグループの（遺伝子発現が増加した遺伝子(up)、有意差が見られなかった遺伝子(NS)）の分布を比較します。<br>
例えば、RPスコアが高いほど遺伝子発現が増加する傾向にある場合、赤色で示すupの線は灰色で示すNSの線より左側で立ち上がります。<br>
Kolmogorov-Smirnov testsにより有意差検定をします。<br>
着目するゲノム領域（RPスコア）と遺伝子発現変動の相関関係がわかります。<br>
<strong>intersect_associated</strong>は選択したintersectに含まれるゲノム領域が近傍に局在する遺伝子です。<br></p>
<p><img src="manual_figure/venn%20barplot.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
</div>
<div id="result-tableパネル-1" class="section level4">
<h4>Result tableパネル</h4>
<p>TranscriptomeとEpigenomeの情報をリンクさせた分類結果を出力します。
例えば、「RNA及びEpigenomeが共にupした遺伝子」や「RNA及びEpigenomeが共にdownした遺伝子」など(<strong>Group(RNA-Epigenome)</strong>より選択可能)の情報をテーブルデータとして出力します。<br>
venn diagramやmotif解析用にbed形式でダウンロードすることも可能です。<br>
興味ある項目をクリックすると、<strong>Trackplotパネル</strong>に選択した領域及び近傍遺伝子のトラックプロットが出力されます。<br><br>
<img src="manual_figure/venn%20rnaseqtrackplot.png" id="id"
class="class" style="width:90.0%" /><br><br></p>
</div>
<div id="functional-enrichment-analysisパネル-1" class="section level4">
<h4>Functional enrichment analysisパネル</h4>
<p>興味あるグループを選択すると、エンリッチメント解析を実行します。<br>
このエンリッチメント解析は、RNA-seq解析におけるエンリッチメント解析方法を使用します（GREATをベースとしたエンリッチメント解析とは異なります）。
解析は、<a
href="https://yulab-smu.top/biomedical-knowledge-mining-book/enrichplot.html">ClusterProfiler</a>に依存します。<br><br>
<img src="manual_figure/venn%20rnaseqenrich.png" id="id" class="class"
style="width:90.0%" /><br><br> —</p>
</div>
</div>
<div id="combined-heatmap-1" class="section level3">
<h3>Combined Heatmap</h3>
<p>選択したIntersectに対応するRNAseqのカウントデータやFoldChange、ChIP-seqやATAC-seqのPeakパターンをHeatmapで同時に可視化します。<br>
必ず<strong>Select
intersection</strong>からヒートマップを描きたいゲノム領域を選択してください。
セッティングパネルのBigWigファイルのアップロードは必須です。<br>
STARTボタンを押すと、解析を実行します。</p>
<hr />
</div>
</div>
</div>
<div id="clustering" class="section level1">
<h1>Clustering</h1>
<p>BigWig fileのクラスタリング解析を実行します。
本セクションの用途は大きく分けて二つあります。
１つ目は、PCAやMDS、dendrogram、correlation
plotによるデータの俯瞰です。アップロードしたデータの大まかな類似性を可視化します。
２つ目は、k-means
clusteringを用いた詳細なゲノム領域の分析です。Pair-wise DARやVenn
diagramで同定した領域をk-means
clusteringを用いて細分化・機能評価を行います。</p>
<div id="setting-2" class="section level2">
<h2>Setting</h2>
<p><img src="manual_figure/clustering%20set.png" id="id" class="class"
style="width:50.0%" /><br></p>
<hr />
<div id="input-format-2" class="section level3">
<h3>Input format</h3>
<p>重要な選択肢は以下の１点です。<br></p>
<ul>
<li><strong>Genomic region</strong>:
Genome-wideまたはPromoterの選択</li>
</ul>
<div id="genomic-region-1" class="section level4">
<h4>Genomic region</h4>
<ul>
<li><p><strong>Genome-wideを選ぶ場合</strong><br> Bed
fileのアップロードが必要となります。<br>
目的がデータの俯瞰の場合は、アップロードしたBigWigファイルに対応する全てのpeak
call fileをアップロードしてください。(Pair-wise
DARのようなFilter機能はありません。アップロードしたbed
fileに含まれる全てのゲノム領域をカウント化します。)<br> 目的がk-means
clusteringを用いた詳細なゲノム領域の分析の場合は、Pair-wise DARやVenn
diagramなどにより得たbed fileをアップロードしてください。
bedファイルに含まれるゲノム領域のみをカウント化します。 （k-means
clusteringを実行できるゲノム領域の数は最大10,000までのため、解析対象となるゲノム領域をある程度絞り込んだbed
fileが必要となります。）</p></li>
<li><p><strong>Filter</strong><br> Reproducible peaks:
各条件に関して再現性のあるピークコール領域のみを抽出します（最低 n =
2でピークコールされる領域）。<br> （例1：A_1 有、A_2 有、B_1 無、B_2 無
→ reproducible、例2：A_1 無、A_2 無、B_1 有、B_2 有 →
reproducible、例2：A_1 有、A_2 無、B_1 無、B_2 有 → NOT reproducible）
ただし、n = 1のサンプルに関しては全てのピークコール領域を抽出します。
ALL peaks: ピークコールされた全ての領域をカウント化します。</p></li>
<li><p><strong>Promoterを選ぶ場合</strong><br> bed
fileのアップロードは不要となります。<br>
Promoter領域の範囲は自由に変更可能です（default: upstream = 500 bp,
downstream = 500 bp）。<br> gene list fileをアップロードすることで、gene
list
fileに含まれる遺伝子のみを抽出します。解析対象となる遺伝子を絞り込むことができます。<br>
Speciesの選択が必須となります。<br><br></p></li>
</ul>
<p>なお、アップロードするファイル名は<strong>Input
fileの共通ルール・注意点</strong>に記載されたルールをお守りください。<br></p>
<hr />
</div>
<div id="species-2" class="section level4">
<h4>Species</h4>
<p>適切な種（リファレンス）を選択することで以下の解析が実行されます。</p>
<ul>
<li>Promoter領域の解析</li>
<li>トラックプロット、peak distribution、GREAT, HOMER, with RNAseqの実行
<br></li>
</ul>
</div>
<div id="cut-off-conditions-1" class="section level4">
<h4>Cut-off conditions</h4>
<p>Fold change, FDRの閾値が設定できます。 <br> <br></p>
<hr />
</div>
</div>
</div>
<div id="output-2" class="section level2">
<h2>Output</h2>
<div id="input-data-1" class="section level3">
<h3>Input Data</h3>
<p>アップロードしたファイル名を表示します。<br>
カウントデータ作成後、カウントデータを表示します。 <br> - <strong>Sample
order</strong><br> BigWigファイルの順番を並び替えることができます。<br>
※ドラッグ&amp;ドロップはできません。テキストを消すようにdeleteボタンで削除し、解析したい順番になるように再入力してください。<br><br>
<img src="manual_figure/clustering%20input.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
<hr />
</div>
<div id="result-overview-1" class="section level3">
<h3>Result overview</h3>
<p>Principal Component Analysis (PCA)、Multi-Dimensional Scaling (MDS),
ward.D2による階層的クラスタリングの3種類のクラスタリング解析を実行します。<br>
また、pearson’s correlationを計算し、correlation
plotを出力します。<br><br> <img
src="manual_figure/clustering%20overview.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
<hr />
</div>
<div id="k-means-clustering" class="section level3">
<h3>k-means clustering</h3>
<p>k-means clusteringを実行します。
解析対象となるゲノム領域の数は、memoryの都合上、最大10,000領域(defaultは2000
loci。<strong>Most variable loci</strong>で変更可能)までです。<br></p>
<ul>
<li><strong>Select a pair for fold change cut-off</strong><br> Fold
changeでcut-offしたい２群を選択できます。<br>
cut-off後のゲノム領域の数が赤字で表示されるので、その数字を参考に<strong>Most
variable loci</strong>を設定してください。<br></li>
<li><strong>k-means number</strong><br>
クラスターの数を設定します。</li>
<li><strong>Most variable loci</strong><br>
cut-off後のゲノム領域の数が<strong>Most variable
loci</strong>で指定した数値を上回る場合、中央絶対偏差(MAD)が大きい領域領域を抽出して解析します。<br></li>
<li><strong>Order of clusters on heatmap</strong><br>
ヒートマップ上のクラスターの順番を変更することができます。<br> ※
デフォルトで階層的クラスタリングにより事前にある程度綺麗に並び替える機能を備えていますが、マニュアル操作で並び替えたい時にご利用ください。</li>
</ul>
<p><img src="manual_figure/clustering%20kmeans.png" id="id"
class="class" style="width:90.0%" /><br><br></p>
<p><strong>cluster_list</strong>から興味あるClusterを選択することで、さらに詳細な解析ができます。<br>
なお、<strong>cluster_list</strong>で複数のClusterを選択した場合は、選択した全てのClusterを同一のClusterとみなして解析します（それぞれのクラスターを個別に解析するわけではありません）。<br></p>
<div id="peak-pattern-2" class="section level4">
<h4>Peak pattern</h4>
<p>選択したClusterのPeak heatmapとline plotを出力します。<br>
追加のデータを表示したい場合には、<strong>select additional bigwig
files</strong>からデータをアップロードしてください。<br><br> <img
src="manual_figure/clustering%20pattern.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
</div>
<div id="trackplotパネル-2" class="section level4">
<h4>Trackplotパネル</h4>
<p><strong>selected cluster
dataパネル</strong>の項目をクリックすると、選択した項目のトラックプロットを表示します。<br>
トラックプロットのハイライト（赤）は、選択した領域を示しています。<br>
トラックプロットのピークの高さは、<strong>peak
range</strong>で変更可能です。<br>
トラックプロットに追加のデータを表示したい場合には、<strong>select
additional bigwig
files</strong>からデータをアップロードしてください。<br><br> <img
src="manual_figure/clustering%20trackplot.png" id="id" class="class"
style="width:90.0%" alt="venn input" /><br><br></p>
<hr />
</div>
</div>
<div id="with-rnaseq-2" class="section level3">
<h3>with RNAseq</h3>
<p>RNA-seqのDEG(発現変動遺伝子) result
fileをアップロードすることで、<strong>k-means cluster
list</strong>から選択したClusterの領域(epigenome)とDEG(transcriptome)の統合解析ができます。<br>
RNA-seqのDEG result fileのフォーマットは以下の通りです。</p>
<ul>
<li>拡張子は、タブ区切りtxt、カンマ区切りcsv、エクセルxlsxのいずれか</li>
<li>1行目はgene symbolまたはENSEMBL ID</li>
<li>カラム名が「log2FoldChange」及び「padj」の列を含む</li>
</ul>
<p>上記の条件を満たせば、bulk
RNA-seqまたはscRNA-seqのデータが使用できます。<br><br> <img
src="manual_figure/pair-wise%20DEG.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
<div id="regulatory-potential-rpをベースとした解析について-2"
class="section level4">
<h4>Regulatory Potential (RP)をベースとした解析について</h4>
<p>Epigenomeの解析結果では、一つの遺伝子に対して複数のピークがassociateするケースがあります。<br>
遺伝子発現とエピゲノム情報を統合解析するためには、まずは上記のような１遺伝子対して複数存在するエピゲノム情報を統合し、一つのスコアにまとめる必要があります。<br>
本アプリでは、エピゲノム情報を一つのスコアにまとめるために<strong>Regulatory
Potential (RP)</strong>の理論を採用しています。<br>
RPスコアはピークの位置がTSSに近いほど高く、TSSから離れるほど低くなるように計算されます。
RPスコアに反映されるTSSからのピークの最大距離は100kb（<strong>Regulatory
range (distance (kb) from TSS)</strong>より変更可能）です。
RNAseqのDEGのcutoffは、<strong>Fold change cutoff for RNA-seq
data</strong>及び<strong>FDR cutoff for RNA-seq
data</strong>より設定できます（defaultはfold change = 1.5, fdr =
0.05）。</p>
</div>
<div id="boxplot-2" class="section level4">
<h4>Boxplot</h4>
<p>RPの値を指標に遺伝子を分類し、各グループのlog2FoldChangeの値をプロットします。<br>
RPの分類はRPが１より大きい遺伝子(RP &gt; 1)、その他(Others)です。<br>
統計解析はWelch’s t-testを実行します。* p&lt;0.05, ** p&lt;0.01, ***
p&lt;0.001<br>
着目するゲノム領域がどの程度遺伝子発現変動に寄与するかがわかります。<br><br>
<img src="manual_figure/clustering%20boxplot.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
</div>
<div id="barplot-2" class="section level4">
<h4>Barplot</h4>
<p>DEGのうち、RPが0以上の遺伝子がどの程度存在するかを積み上げ棒グラフで表示する。<br>
また逆に、RPが0以上の遺伝子のうち、DEGがどの程度存在するかを表示する。<br><br></p>
</div>
<div id="ks-plot-2" class="section level4">
<h4>KS plot</h4>
<p>RPスコアが高い順に遺伝子を並べて、２つのグループの（遺伝子発現が増加した遺伝子(up)、有意差が見られなかった遺伝子(NS)）の分布を比較します。<br>
例えば、RPスコアが高いほど遺伝子発現が増加する傾向にある場合、赤色で示すupの線は灰色で示すNSの線より左側で立ち上がります。<br>
Kolmogorov-Smirnov testsにより有意差検定をします。<br>
着目するゲノム領域（RPスコア）と遺伝子発現変動の相関関係がわかります。<br>
<strong>cluster_associated</strong>は選択したclusterに含まれるゲノム領域が近傍に局在する遺伝子です。<br><br>
<img src="manual_figure/clustering%20barplot.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
</div>
<div id="result-tableパネル-2" class="section level4">
<h4>Result tableパネル</h4>
<p>TranscriptomeとEpigenomeの情報をリンクさせた分類結果を出力します。
例えば、「RNA及びEpigenomeが共にupした遺伝子」や「RNA及びEpigenomeが共にdownした遺伝子」など(<strong>Group(RNA-Epigenome)</strong>より選択可能)の情報をテーブルデータとして出力します。<br>
venn diagramやmotif解析用にbed形式でダウンロードすることも可能です。<br>
興味ある項目をクリックすると、<strong>Trackplotパネル</strong>に選択した領域及び近傍遺伝子のトラックプロットが出力されます。<br><br>
<img src="manual_figure/clustering%20rnaseqtrackplot.png" id="id"
class="class" style="width:90.0%" /><br><br></p>
</div>
<div id="functional-enrichment-analysisパネル-2" class="section level4">
<h4>Functional enrichment analysisパネル</h4>
<p>興味あるグループを選択すると、エンリッチメント解析を実行します。<br>
このエンリッチメント解析は、RNA-seq解析におけるエンリッチメント解析方法を使用します（GREATをベースとしたエンリッチメント解析とは異なります）。
解析は、<a
href="https://yulab-smu.top/biomedical-knowledge-mining-book/enrichplot.html">ClusterProfiler</a>に依存します。<br><br>
<img src="manual_figure/clustering%20rnaseqenrich.png" id="id"
class="class" style="width:90.0%" /><br><br></p>
<hr />
</div>
</div>
</div>
</div>
<div id="enrichment-viewer" class="section level1">
<h1>Enrichment viewer</h1>
<p>bed
fileに含まれるゲノム領域に対してエンリッチメント解析を実行します。<br>
Venn diagramやk-means
clusteringの結果を用いることで、同定したグループ・クラスターの機能やモチーフを比較・可視化します。
<br><br></p>
<div id="setting-3" class="section level2">
<h2>Setting</h2>
<p><img src="manual_figure/enrich%20set.png" id="id" class="class"
style="width:50.0%" alt="venn diagram set" /><br></p>
<hr />
<div id="input-format-3" class="section level3">
<h3>Input format</h3>
<div id="input-2" class="section level4">
<h4>Input</h4>
<ul>
<li><strong>Bed files</strong><br> Enrichment
viewerにおいて必ず必要となるファイルです。<br>
ファイル名はFigure中のサンプル名として使用されます。<br>
長すぎるファイル名はFigure作成に悪影響を及ぼすため、シンプルなファイル名を推奨します。<br></li>
</ul>
<hr />
</div>
<div id="species-3" class="section level4">
<h4>Species</h4>
<p>適切な種（リファレンス）の選択が必須です。 <br></p>
<hr />
</div>
</div>
</div>
<div id="output-3" class="section level2">
<h2>Output</h2>
<div id="input-list" class="section level3">
<h3>Input list</h3>
<p>アップロードしたファイル名を表示します。 <br><br> <img
src="manual_figure/enrich%20input.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
<hr />
</div>
<div id="great-2" class="section level3">
<h3>GREAT</h3>
<p>GREAT (Genomic Regions Enrichment of Annotations
Tool)をベースとしたエンリッチメント解析により、アップロードしたbed
fileに含まれるゲノム領域の機能をそれぞれ同定・可視化します。<br>
解析に使用できる遺伝子セットは、以下の通りです。<br> <a
href="http://www.gsea-msigdb.org/gsea/msigdb/genesets.jsp?collection=H">MSigDB
hallmark gene</a> <br> <a href="https://www.kegg.jp">KEGG</a> <br> <a
href="https://reactome.org">Reactome</a> <br> <a
href="https://maayanlab.cloud/Harmonizome/resource/Pathway+Interaction+Database">PID
(Pathway Interaction Database)</a> <br> <a
href="https://maayanlab.cloud/Harmonizome/dataset/Biocarta+Pathways">BioCarta</a>
<br> <a
href="https://www.wikipathways.org/index.php/WikiPathways">WikiPathways</a>
<br> <a href="http://geneontology.org">GO (biological process, cellular
component, and molecular function)</a> <br> <a
href="https://hpo.jax.org/app/">Human phenotype ontology</a> <br> <a
href="https://saezlab.github.io/dorothea/">DoRothEA regulon
(activator)</a> <br> <a
href="https://saezlab.github.io/dorothea/">DoRothEA regulon
(repressor)</a> <br> <a
href="http://www.gsea-msigdb.org/gsea/msigdb/genesets.jsp?collection=TFT">Transcription
factor targets</a> <br> <a
href="http://www.gsea-msigdb.org/gsea/msigdb/genesets.jsp?collection=MIR">miRNA
target</a> <br> 注) 転写因子の予測解析は<strong>DoRothEA
regulon</strong>の使用を推奨します。<br><br></p>
<p>解析は、<a
href="https://bioconductor.org/packages/release/bioc/vignettes/rGREAT/inst/doc/local-GREAT.html">rGREAT</a>に依存します。<br><br>
<img src="manual_figure/enrich%20great.png" id="id" class="class"
style="width:90.0%" alt="venn input" /><br><br></p>
<hr />
</div>
<div id="homer-2" class="section level3">
<h3>HOMER</h3>
<p>HOMER (Hypergeometric Optimization of Motif
EnRichment)をベースとしたエンリッチメント解析により、アップロードしたbed
fileに含まれるゲノム領域に含まれるDNA結合モチーフをそれぞれ同定します。<br></p>
<div id="type-of-enrichment-analysis-2" class="section level4">
<h4>Type of enrichment analysis</h4>
<p>“known motif”: known motifのみ解析します。<br> “known + unknown
motif”: known motifに加えてunknown motifの解析も行います。<br></p>
</div>
<div id="type-of-the-region-for-motif-finding-2" class="section level4">
<h4>Type of the region for motif finding</h4>
<p>“given (exact size)”:
各ピークの全領域を解析します。修飾ヒストンのようなbroadなpeakの解析に有効です。<br>
“custom size”: ピークの中央から指定したサイズ(default:
200)に絞って解析します。ATAC-seqやDNA結合タンパク質の解析に有効です。<br></p>
</div>
<div id="background-sequence-2" class="section level4">
<h4>Background sequence</h4>
<p>“ramdom”:ゲノム領域からランダムにbackground
sequenceを抽出します。<br> “bed files”: Background
file(bed形式)をアップロードするためのウィンドウが出現します。 複数のbed
filesをアップロードした場合は、mergeしたファイルをbackground
fileとして利用します。
backgroundファイルのうち、解析対象を除いた領域をbackgroundとして利用します。<br>
randomと比べてよりspecificなmotifが予測できる可能性があります。</p>
</div>
<div id="download-homer-report-2" class="section level4">
<h4>Download homer report</h4>
<p>HOMERの実行結果がzip形式で一括downloadできます。<br><br> <img
src="manual_figure/venn%20motif.png" id="id" class="class"
style="width:90.0%" alt="venn input" /><br><br> —</p>
</div>
</div>
<div id="combined-heatmap-2" class="section level3">
<h3>Combined Heatmap</h3>
<p>Bed
fileに含まれる位置情報に対応するRNAseqのカウントデータやFoldChange、ChIP-seqやATAC-seqのPeakパターンをHeatmapで同時に可視化します。<br>
タブパネル上部のBigWigファイルのアップロードは必須です。<br>
STARTボタンを押すと、解析を実行します。</p>
<p><img src="manual_figure/enrich%20combined.png" id="id" class="class"
style="width:90.0%" /><br><br></p>
<hr />
</div>
</div>
</div>
<div id="more" class="section level1">
<h1>More</h1>
<div id="bedtools" class="section level2">
<h2>bedtools</h2>
<p>ゲノムの位置情報を扱うBed fileの演算が可能です。<br>
処理可能なファイル様式はbed形式 (.bedまたは.narrowPeak)のみです。<br>
全機能は<a
href="https://haizi-zh.github.io/bedtorch/">bedtorch</a>に依存します。<br></p>
<div id="merge-interval" class="section level3">
<h3>Merge interval</h3>
<p>隣り合う領域のサイズが指定したサイズ(<strong>Gap
size</strong>より変更可能)以下の場合、隣り合う領域をマージしたファイルを作成します。<br>
<br><br> <img src="manual_figure/merge_interval.png" id="id"
class="class" style="width:90.0%" alt="venn input" /><br><br></p>
</div>
<div id="subtract" class="section level3">
<h3>Subtract</h3>
<p>AからBの領域を引いたファイルを作成します。<br><br> <img
src="manual_figure/subtract.png" id="id" class="class"
style="width:90.0%" alt="venn input" /><br><br></p>
</div>
<div id="intersect" class="section level3">
<h3>Intersect</h3>
<p>AのうちBとoverlapする領域だけを抽出したファイルを作成します。<br>
(-wa option)
Bとoverlapする領域をそのまま抽出したファイルを作成します。<br> (-v
option) Bとoverlapしない領域のみを抽出したファイルを作成します。<br><br>
<img src="manual_figure/intersect.png" id="id" class="class"
style="width:90.0%" alt="venn input" /><br><br></p>
<hr />
</div>
</div>
</div>
<div id="tips" class="section level1">
<h1>Tips</h1>
<div id="homer-background-sequenceの差" class="section level2">
<h2>HOMER: Background sequenceの差</h2>
<p>例: ATAC-seqのサンプルでpair-wise DARを実行 <img
src="manual_figure/motif%20background.png" id="id" class="class"
style="width:100.0%" alt="venn input" /><br><br></p>
</div>
<div id="chip-atlasのデータの注意点修飾ヒストンのchip-seqデータの解析"
class="section level2">
<h2>ChIP-atlasのデータの注意点：修飾ヒストンのChIP-seqデータの解析</h2>
<p><img src="manual_figure/chipatlas_1.png" id="id" class="class"
style="width:100.0%" alt="venn input" /><br><br> <img
src="manual_figure/chipatlas_2.png" id="id" class="class"
style="width:100.0%" alt="venn input" /><br><br></p>
<hr />
</div>
</div>
<div id="reference" class="section level1">
<h1>Reference</h1>
<p>Shiny framework</p>
<ul>
<li>Winston Chang, Joe Cheng, JJ Allaire, Carson Sievert, Barret
Schloerke, Yihui Xie, Jeff Allen, Jonathan McPherson, Alan Dipert and
Barbara Borges (2021). shiny: Web Application Framework for R. R package
version 1.7.1. <a href="https://CRAN.R-project.org/package=shiny"
class="uri">https://CRAN.R-project.org/package=shiny</a></li>
<li>Eric Bailey (2022). shinyBS: Twitter Bootstrap Components for Shiny.
R package version 0.61.1. <a
href="https://CRAN.R-project.org/package=shinyBS"
class="uri">https://CRAN.R-project.org/package=shinyBS</a></li>
<li>Yihui Xie, Joe Cheng and Xianying Tan (2022). DT: A Wrapper of the
JavaScript Library ‘DataTables’. R package version 0.23. <a
href="https://CRAN.R-project.org/package=DT"
class="uri">https://CRAN.R-project.org/package=DT</a></li>
</ul>
<p>DESeq2 and limma (for differential accessibility region analysis)</p>
<ul>
<li>Love, M.I., Huber, W., Anders, S. Moderated estimation of fold
change and dispersion for RNA-seq data with DESeq2 Genome Biology
15(12):550 (2014)</li>
<li>Ritchie, M.E., Phipson, B., Wu, D., Hu, Y., Law, C.W., Shi, W., and
Smyth, G.K. (2015). limma powers differential expression analyses for
RNA-sequencing and microarray studies. Nucleic Acids Research 43(7),
e47.</li>
</ul>
<p>ggdendro (for dendrograms)</p>
<ul>
<li>Andrie de Vries and Brian D. Ripley (2020). ggdendro: Create
Dendrograms and Tree Diagrams Using ‘ggplot2’. R package version 0.1.22.
<a href="https://CRAN.R-project.org/package=ggdendro"
class="uri">https://CRAN.R-project.org/package=ggdendro</a></li>
</ul>
<p>ggcorrplot (for correlation plot)</p>
<ul>
<li>Kassambara A (2022). <em>ggcorrplot: Visualization of a Correlation
Matrix using ‘ggplot2’</em>. R package version 0.1.4, <a
href="https://CRAN.R-project.org/package=ggcorrplot"
class="uri">https://CRAN.R-project.org/package=ggcorrplot</a>.</li>
</ul>
<p>rGREAT, clusterProfiler, DOSE, msigdbr, dorothea (for enrichment
analysis)</p>
<ul>
<li>Gu Z (2022). <em>rGREAT: GREAT Analysis - Functional Enrichment on
Genomic Regions</em>. <a href="https://github.com/jokergoo/rGREAT"
class="uri">https://github.com/jokergoo/rGREAT</a>, <a
href="http://great.stanford.edu/public/html/"
class="uri">http://great.stanford.edu/public/html/</a>.</li>
<li>T Wu, E Hu, S Xu, M Chen, P Guo, Z Dai, T Feng, L Zhou, W Tang, L
Zhan, X Fu, S Liu, X Bo, and G Yu. clusterProfiler 4.0: A universal
enrichment tool for interpreting omics data. The Innovation. 2021,
2(3):100141</li>
<li>Guangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an
R/Bioconductor package for Disease Ontology Semantic and Enrichment
analysis. Bioinformatics 2015 31(4):608-609</li>
<li>Dolgalev I (2022). <em>msigdbr: MSigDB Gene Sets for Multiple
Organisms in a Tidy Data Format</em>. R package version 7.5.1, <a
href="https://CRAN.R-project.org/package=msigdbr"
class="uri">https://CRAN.R-project.org/package=msigdbr</a>.</li>
<li>Garcia-Alonso L, Holland CH, Ibrahim MM, Turei D, Saez-Rodriguez J.
‘Benchmark and integration of resources for the estimation of human
transcription factor activities.’ Genome Research. 2019. DOI:
10.1101/gr.240663.118.</li>
</ul>
<p>AnnotationDbi, Rpackages for annotation (for genome wide
annotation)</p>
<ul>
<li>Hervé Pagès, Marc Carlson, Seth Falcon and Nianhua Li (2020).
AnnotationDbi: Manipulation of SQLite-based annotations in Bioconductor.
R package version 1.52.0. <a
href="https://bioconductor.org/packages/AnnotationDbi"
class="uri">https://bioconductor.org/packages/AnnotationDbi</a></li>
<li>Marc Carlson (2020). org.Hs.eg.db: Genome wide annotation for Human.
R package version 3.12.0.</li>
<li>Marc Carlson (2020). org.Mm.eg.db: Genome wide annotation for Mouse.
R package version 3.12.0.</li>
<li>Marc Carlson (2022). org.Rn.eg.db: Genome wide annotation for Rat. R
package version 3.15.0.</li>
<li>Marc Carlson (2022). org.Xl.eg.db: Genome wide annotation for Worm.
R package version 3.15.0.</li>
<li>Marc Carlson (2022). org.Dm.eg.db: Genome wide annotation for Rat. R
package version 3.15.0.</li>
<li>Marc Carlson (2022). org.Ce.eg.db: Genome wide annotation for Worm.
R package version 3.15.0.</li>
<li>Marc Carlson (2022). org.Bt.eg.db: Genome wide annotation for
Bovine. R package version 3.15.0.</li>
<li>Marc Carlson (2022). org.Cf.eg.db: Genome wide annotation for
Canine. R package version 3.15.0.</li>
<li>Marc Carlson (2022). org.Dr.eg.db: Genome wide annotation for
Zebrafish. R package version 3.15.0.</li>
<li>Marc Carlson (2022). org.Gg.eg.db: Genome wide annotation for
Chicken. R package version 3.15.0.</li>
<li>Marc Carlson (2022). org.Mmu.eg.db: Genome wide annotation for
Rhesus. R package version 3.15.0.</li>
<li>Marc Carlson (2022). org.Pt.eg.db: Genome wide annotation for Chimp.
R package version 3.15.0.</li>
<li>Müller K, Ooms J, James D, DebRoy S, Wickham H, Horner J (2022).
RMariaDB: Database Interface and MariaDB Driver. R package version
1.2.2, <a href="https://CRAN.R-project.org/package=RMariaDB"
class="uri">https://CRAN.R-project.org/package=RMariaDB</a>.</li>
</ul>
<p>biomart (for interspecies gene_ID conversion)</p>
<ul>
<li>Mapping identifiers for the integration of genomic datasets with the
R/Bioconductor package biomaRt. Steffen Durinck, Paul T. Spellman, Ewan
Birney and Wolfgang Huber, Nature Protocols 4, 1184-1191 (2009).</li>
</ul>
<p>genefilter (for z-score normalization)</p>
<ul>
<li>R. Gentleman, V. Carey, W. Huber and F. Hahne (2021). genefilter:
methods for filtering genes from high-throughput experiments. R package
version 1.72.1.</li>
</ul>
<p>ComplexHeatmap (for heatmap and k-means clustering)</p>
<ul>
<li>Gu, Z. (2016) Complex heatmaps reveal patterns and correlations in
multidimensional genomic data. Bioinformatics.</li>
</ul>
<p>ggplot2 and ggpubr (for boxplot and scater plot)</p>
<ul>
<li>H. Wickham. ggplot2: Elegant Graphics for Data Analysis.
Springer-Verlag New York, 2016.</li>
<li>Alboukadel Kassambara (2020). ggpubr: ‘ggplot2’ Based Publication
Ready Plots. R package version 0.4.0. <a
href="https://CRAN.R-project.org/package=ggpubr"
class="uri">https://CRAN.R-project.org/package=ggpubr</a></li>
</ul>
<p>venn (for venn diagram analysis)</p>
<ul>
<li>Mitjavila-Ventura A (2022). <em>plotmics: Visualization of Omics And
Sequencing Data In R</em>. <a
href="https://amitjavilaventura.github.io/plotmics/index.html"
class="uri">https://amitjavilaventura.github.io/plotmics/index.html</a>,
<a href="https://github.com/amitjavilaventura/plotmics"
class="uri">https://github.com/amitjavilaventura/plotmics</a>.</li>
</ul>
<p>GenomicRanges, soGGi, ChIPQC,ChIPseeker,TxDbs (for manupilate genomic
information and annotation)</p>
<ul>
<li>Lawrence M, Huber W, Pag`es H, Aboyoun P, Carlson M, et al. (2013)
Software for Computing and Annotating Genomic Ranges. PLoS Comput Biol
9(8): e1003118. <a href="doi:10.1371/journal.pcbi.1003118"
class="uri">doi:10.1371/journal.pcbi.1003118</a>”</li>
<li>Dharmalingam G, Carroll T (2015). <em>soGGi: Visualise ChIP-seq,
MNase-seq and motif occurrence as aggregate plots Summarised Over
Grouped Genomic Intervals</em>. R package version 1.10.4.</li>
<li>Thomas Samuel Carroll, Ziwei Liang, Rafik Salama, Rory Stark, Ines
de Santiago: Impact of artefact removal on ChIP quality metrics in
ChIP-seq and ChIP-exo data. Frontiers in Genetics, in press.</li>
<li>Guangchuang Yu, Li-Gen Wang, and Qing-Yu He. ChIPseeker: an
R/Bioconductor package for ChIP peak annotation, comparison and
visualization. Bioinformatics 2015, 31(14):2382-2383</li>
<li>Lihua J Zhu, Claude Gazin, Nathan D Lawson, Herve Pages, Simon M
Lin, David S Lapointe and Michael R Green, ChIPpeakAnno: a Bioconductor
package to annotate ChIP-seq and ChIP-chip data. BMC Bioinformatics.
2010, 11:237</li>
<li>Team BC, Maintainer BP (2019).
<em>TxDb.Mmusculus.UCSC.mm10.knownGene: Annotation package for TxDb
object(s)</em>. R package version 3.10.0.</li>
<li>Carlson M, Maintainer BP (2015).
<em>TxDb.Hsapiens.UCSC.hg19.knownGene: Annotation package for TxDb
object(s)</em>. R package version 3.2.2.</li>
<li>Team BC, Maintainer BP (2022).
<em>TxDb.Hsapiens.UCSC.hg38.knownGene: Annotation package for TxDb
object(s)</em>. R package version 3.15.0.</li>
<li>Team BC, Maintainer BP (2020).
<em>TxDb.Dmelanogaster.UCSC.dm6.ensGene: Annotation package for TxDb
object(s)</em>. R package version 3.12.0.</li>
<li>Team BC, Maintainer BP (2019).
<em>TxDb.Rnorvegicus.UCSC.rn6.refGene: Annotation package for TxDb
object(s)</em>. R package version 3.4.6.</li>
<li>Team BC, Maintainer BP (2019). <em>TxDb.Celegans.UCSC.ce11.refGene:
Annotation package for TxDb object(s)</em>. R package version
3.4.6.</li>
<li>Team BC, Maintainer BP (2020).
<em>TxDb.Btaurus.UCSC.bosTau8.refGene: Annotation package for TxDb
object(s)</em>. R package version 3.12.0.</li>
<li>Team BC, Maintainer BP (2020).
<em>TxDb.Cfamiliaris.UCSC.canFam3.refGene: Annotation package for TxDb
object(s)</em>. R package version 3.11.0.</li>
<li>Team BC, Maintainer BP (2019).
<em>TxDb.Drerio.UCSC.danRer10.refGene: Annotation package for TxDb
object(s)</em>. R package version 3.4.6.</li>
<li>Team BC, Maintainer BP (2020).
<em>TxDb.Ggallus.UCSC.galGal4.refGene: Annotation package for TxDb
object(s)</em>. R package version 3.12.0.</li>
<li>Team BC, Maintainer BP (2020).
<em>TxDb.Mmulatta.UCSC.rheMac8.refGene: Annotation package for TxDb
object(s)</em>. R package version 3.12.0.</li>
<li>Team BC, Maintainer BP (2020).
<em>TxDb.Ptroglodytes.UCSC.panTro4.refGene: Annotation package for TxDb
object(s)</em>. R package version 3.12.0.</li>
</ul>
<p>dplyr and tidyr (for data manipulation)</p>
<ul>
<li>Hadley Wickham, Romain François, Lionel Henry and Kirill Müller
(2021). dplyr: A Grammar of Data Manipulation. R package version 1.0.7.
<a href="https://CRAN.R-project.org/package=dplyr"
class="uri">https://CRAN.R-project.org/package=dplyr</a></li>
<li>Hadley Wickham (2021). tidyr: Tidy Messy Data. R package version
1.1.3. <a href="https://CRAN.R-project.org/package=tidyr"
class="uri">https://CRAN.R-project.org/package=tidyr</a></li>
</ul>
<p>rtracklayer, Rsubread, Rsamtools</p>
<ul>
<li>M. Lawrence, R. Gentleman, V. Carey: “rtracklayer: an {R} package
for interfacing with genome browsers”. Bioinformatics 25:1841-1842.</li>
<li>Liao Y, Smyth GK and Shi W (2019). The R package Rsubread is easier,
faster, cheaper and better for alignment and quantification of RNA
sequencing reads. Nucleic Acids Research 47(8), e47.</li>
<li>Morgan M, Pagès H, Obenchain V, Hayden N (2022). <em>Rsamtools:
Binary alignment (BAM), FASTA, variant call (BCF), and tabix file
import</em>. R package version 2.12.0, <a
href="https://bioconductor.org/packages/Rsamtools"
class="uri">https://bioconductor.org/packages/Rsamtools</a>.</li>
</ul>
<p>FindIT2 (for with RNAseq)</p>
<ul>
<li>Shang, G.-D., Xu, Z.-G., Wan, M.-C., Wang, F.-X. &amp; Wang, J.-W.
FindIT2: an R/Bioconductor package to identify influential transcription
factor and targets based on multi-omics data. BMC Genomics 23, 272
(2022)</li>
</ul>
<p>marge, ggseqlogo (for motif analysis)</p>
<ul>
<li>Amezquita R (2022). <em>marge: API for HOMER in R for Genomic
Analysis using Tidy Conventions</em>. R package version 0.0.4.9999.</li>
<li>Wagih O (2017). <em>ggseqlogo: A ‘ggplot2’ Extension for Drawing
Publication-Ready Sequence Logos</em>. R package version 0.1, <a
href="https://CRAN.R-project.org/package=ggseqlogo"
class="uri">https://CRAN.R-project.org/package=ggseqlogo</a>.</li>
</ul>
<p>colorspace</p>
<ul>
<li>Zeileis A, Hornik K, Murrell P (2009). “Escaping RGBland: Selecting
Colors for Statistical Graphics.” <em>Computational Statistics &amp;
Data Analysis</em>, <em>53</em>(9), 3259-3270. <a
href="doi:10.1016/j.csda.2008.11.033"
class="uri">doi:10.1016/j.csda.2008.11.033</a> <a
href="https://doi.org/10.1016/j.csda.2008.11.033"
class="uri">https://doi.org/10.1016/j.csda.2008.11.033</a>.</li>
</ul>
<p>bedtorch (for bedtools)</p>
<ul>
<li>Zheng H (2021). <em>bedtorch: R package for fast BED-file
manipulation</em>. R package version 0.1.12.12, <a
href="https://github.com/haizi-zh/bedtorch"
class="uri">https://github.com/haizi-zh/bedtorch</a>.</li>
</ul>
<p>Gviz (for track plot)</p>
<ul>
<li>Hahne F, Ivanek R. Visualizing Genomic Data Using Gviz and
Bioconductor. Methods Mol Biol. 1418:335-51 (2016).</li>
</ul>
<hr />
</div>
<div id="license" class="section level1">
<h1>License</h1>
<p>This shiny code is licensed under the GPLv3. Please see the file
LICENSE.md for information.</p>
<pre><code>EpigenomeChef
Shiny App for highlighting epigenome-transcriptome interaction.
Copyright (C) 2023  Kan Etoh

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.

You may contact the author of this code, Kan Etoh, at &lt;kaneto@kumamoto-u.ac.jp&gt;</code></pre>
<hr />
</div>
<div id="session-info" class="section level1">
<h1>Session info</h1>
<pre class="r"><code> sessionInfo()</code></pre>
<pre><code>## R version 4.2.3 (2023-03-15)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur ... 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
##  [1] grid      tools     stats4    stats     graphics  grDevices utils    
##  [8] datasets  methods   base     
## 
## other attached packages:
##   [1] Gviz_1.40.1                                  
##   [2] webshot_0.5.4                                
##   [3] magick_2.7.4                                 
##   [4] pdftools_3.3.3                               
##   [5] EnrichedHeatmap_1.26.0                       
##   [6] ggrastr_1.0.1                                
##   [7] ggsci_3.0.0                                  
##   [8] reshape2_1.4.4                               
##   [9] venn_1.11                                    
##  [10] RColorBrewer_1.1-3                           
##  [11] ggcorrplot_0.1.4                             
##  [12] colorspace_2.1-0                             
##  [13] plotmics_7.0.1                               
##  [14] marge_0.0.4.9999                             
##  [15] ggseqlogo_0.1                                
##  [16] limma_3.52.4                                 
##  [17] FindIT2_1.2.3                                
##  [18] rGREAT_1.28.0                                
##  [19] ChIPpeakAnno_3.30.1                          
##  [20] ChIPseeker_1.32.1                            
##  [21] soGGi_1.10.4                                 
##  [22] dorothea_1.8.0                               
##  [23] clusterProfiler.dplyr_0.0.2                  
##  [24] BiocManager_1.30.20                          
##  [25] shinyjs_2.1.0                                
##  [26] plotly_4.10.1                                
##  [27] shinyBS_0.61.1                               
##  [28] ComplexHeatmap_2.12.1                        
##  [29] genefilter_1.78.0                            
##  [30] msigdbr_7.5.1                                
##  [31] DOSE_3.22.1                                  
##  [32] enrichplot_1.16.2                            
##  [33] clusterProfiler_4.4.4                        
##  [34] ggnewscale_0.4.8                             
##  [35] DESeq2_1.36.0                                
##  [36] SummarizedExperiment_1.26.1                  
##  [37] MatrixGenerics_1.8.1                         
##  [38] matrixStats_0.63.0                           
##  [39] cowplot_1.1.1                                
##  [40] gridExtra_2.3                                
##  [41] ggplotify_0.1.0                              
##  [42] ggdendro_0.1.23                              
##  [43] ggrepel_0.9.3                                
##  [44] ggpubr_0.6.0                                 
##  [45] lubridate_1.9.2                              
##  [46] forcats_1.0.0                                
##  [47] stringr_1.5.0                                
##  [48] dplyr_1.1.2                                  
##  [49] purrr_1.0.1                                  
##  [50] readr_2.1.4                                  
##  [51] tidyr_1.3.0                                  
##  [52] tibble_3.2.1                                 
##  [53] ggplot2_3.4.2                                
##  [54] tidyverse_2.0.0                              
##  [55] multcomp_1.4-23                              
##  [56] TH.data_1.1-2                                
##  [57] MASS_7.3-58.2                                
##  [58] survival_3.5-3                               
##  [59] mvtnorm_1.1-3                                
##  [60] rstatix_0.7.2                                
##  [61] gdata_2.19.0                                 
##  [62] DT_0.27                                      
##  [63] shiny_1.7.4                                  
##  [64] biomaRt_2.52.0                               
##  [65] org.Pt.eg.db_3.15.0                          
##  [66] org.Mmu.eg.db_3.15.0                         
##  [67] org.Gg.eg.db_3.15.0                          
##  [68] org.Dr.eg.db_3.15.0                          
##  [69] org.Cf.eg.db_3.15.0                          
##  [70] org.Bt.eg.db_3.15.0                          
##  [71] org.Xl.eg.db_3.15.0                          
##  [72] org.Ce.eg.db_3.15.0                          
##  [73] org.Dm.eg.db_3.15.0                          
##  [74] org.Rn.eg.db_3.15.0                          
##  [75] org.Mm.eg.db_3.15.0                          
##  [76] org.Hs.eg.db_3.15.0                          
##  [77] TxDb.Ptroglodytes.UCSC.panTro4.refGene_3.12.0
##  [78] TxDb.Mmulatta.UCSC.rheMac8.refGene_3.12.0    
##  [79] TxDb.Ggallus.UCSC.galGal4.refGene_3.12.0     
##  [80] TxDb.Drerio.UCSC.danRer10.refGene_3.4.6      
##  [81] TxDb.Cfamiliaris.UCSC.canFam3.refGene_3.11.0 
##  [82] TxDb.Btaurus.UCSC.bosTau8.refGene_3.12.0     
##  [83] TxDb.Celegans.UCSC.ce11.refGene_3.4.6        
##  [84] TxDb.Rnorvegicus.UCSC.rn6.refGene_3.4.6      
##  [85] TxDb.Dmelanogaster.UCSC.dm6.ensGene_3.12.0   
##  [86] TxDb.Mmusculus.UCSC.mm10.knownGene_3.10.0    
##  [87] TxDb.Hsapiens.UCSC.hg38.knownGene_3.15.0     
##  [88] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2      
##  [89] GenomicFeatures_1.48.4                       
##  [90] AnnotationDbi_1.58.0                         
##  [91] Biobase_2.56.0                               
##  [92] Rsamtools_2.12.0                             
##  [93] Biostrings_2.64.1                            
##  [94] XVector_0.36.0                               
##  [95] Rsubread_2.10.5                              
##  [96] rtracklayer_1.56.1                           
##  [97] GenomicRanges_1.48.0                         
##  [98] GenomeInfoDb_1.32.4                          
##  [99] IRanges_2.30.1                               
## [100] S4Vectors_0.34.0                             
## [101] BiocGenerics_0.42.0                          
## 
## loaded via a namespace (and not attached):
##   [1] Hmisc_5.0-1              glmnet_4.1-7             foreach_1.5.2           
##   [4] crayon_1.5.2             nlme_3.1-162             backports_1.4.1         
##   [7] GOSemSim_2.22.0          rlang_1.1.0              filelock_1.0.2          
##  [10] BiocParallel_1.30.4      rjson_0.2.21             chipseq_1.46.0          
##  [13] bcellViper_1.32.0        bit64_4.0.5              glue_1.6.2              
##  [16] vipor_0.4.5              parallel_4.2.3           regioneR_1.28.0         
##  [19] tidyselect_1.2.0         XML_3.99-0.14            zoo_1.8-12              
##  [22] GenomicAlignments_1.32.1 xtable_1.8-4             magrittr_2.0.3          
##  [25] evaluate_0.20            cli_3.6.1                zlibbioc_1.42.0         
##  [28] RVenn_1.1.0              hwriter_1.3.2.1          rstudioapi_0.14         
##  [31] rpart_4.1.19             bslib_0.4.2              fastmatch_1.1-3         
##  [34] ensembldb_2.20.2         lambda.r_1.2.4           treeio_1.20.2           
##  [37] xfun_0.39                askpass_1.1              clue_0.3-64             
##  [40] multtest_2.52.0          cluster_2.1.4            caTools_1.18.2          
##  [43] tidygraph_1.2.3          KEGGREST_1.36.3          biovizBase_1.44.0       
##  [46] ape_5.7-1                png_0.1-8                withr_2.5.0             
##  [49] bitops_1.0-7             ggforce_0.4.1            RBGL_1.72.0             
##  [52] plyr_1.8.8               AnnotationFilter_1.20.0  pillar_1.9.0            
##  [55] gplots_3.1.3             GlobalOptions_0.1.2      cachem_1.0.7            
##  [58] GetoptLong_1.0.5         vctrs_0.6.2              ellipsis_0.3.2          
##  [61] generics_0.1.3           qpdf_1.3.2               foreign_0.8-84          
##  [64] beeswarm_0.4.0           munsell_0.5.0            tweenr_2.0.2            
##  [67] fgsea_1.22.0             DelayedArray_0.22.0      fastmap_1.1.1           
##  [70] compiler_4.2.3           abind_1.4-5              httpuv_1.6.9            
##  [73] GenomeInfoDbData_1.2.8   InteractionSet_1.24.0    lattice_0.20-45         
##  [76] deldir_1.0-6             utf8_1.2.3               later_1.3.0             
##  [79] BiocFileCache_2.4.0      jsonlite_1.8.4           scales_1.2.1            
##  [82] graph_1.74.0             tidytree_0.4.2           carData_3.0-5           
##  [85] lazyeval_0.2.2           promises_1.2.0.1         car_3.1-2               
##  [88] doParallel_1.0.17        latticeExtra_0.6-30      checkmate_2.1.0         
##  [91] rmarkdown_2.21           sandwich_3.0-2           ggVennDiagram_1.2.2     
##  [94] dichromat_2.0-0.1        downloader_0.4           BSgenome_1.64.0         
##  [97] igraph_1.4.2             yaml_2.3.7               plotrix_3.8-2           
## [100] htmltools_0.5.5          memoise_2.0.1            VariantAnnotation_1.42.1
## [103] BiocIO_1.6.0             locfit_1.5-9.7           graphlayouts_0.8.4      
## [106] viridisLite_0.4.1        digest_0.6.31            mime_0.12               
## [109] rappdirs_0.3.3           futile.options_1.0.1     RSQLite_2.3.1           
## [112] yulab.utils_0.0.6        VennDiagram_1.7.3        data.table_1.14.8       
## [115] blob_1.2.4               futile.logger_1.4.3      preprocessCore_1.58.0   
## [118] Formula_1.2-5            splines_4.2.3            ProtGenerics_1.28.0     
## [121] RCurl_1.98-1.12          broom_1.0.4              hms_1.1.3               
## [124] base64enc_0.1-3          ggbeeswarm_0.7.1         shape_1.4.6             
## [127] aplot_0.1.10             nnet_7.3-18              sass_0.4.5              
## [130] Rcpp_1.0.10              circlize_0.4.15          fansi_1.0.4             
## [133] tzdb_0.3.0               R6_2.5.1                 lifecycle_1.0.3         
## [136] formatR_1.14             ShortRead_1.54.0         curl_5.0.0              
## [139] ggsignif_0.6.4           jquerylib_0.1.4          DO.db_2.9               
## [142] Matrix_1.5-3             qvalue_2.28.0            iterators_1.0.14        
## [145] htmlwidgets_1.6.2        polyclip_1.10-4          shadowtext_0.1.2        
## [148] timechange_0.2.0         gridGraphics_0.5-1       htmlTable_2.4.1         
## [151] patchwork_1.1.2          codetools_0.2-19         GO.db_3.15.0            
## [154] gtools_3.9.4             prettyunits_1.1.1        dbplyr_2.3.2            
## [157] gtable_0.3.3             DBI_1.1.3                ggfun_0.0.9             
## [160] httr_1.4.5               KernSmooth_2.23-20       stringi_1.7.12          
## [163] progress_1.2.2           farver_2.1.1             annotate_1.74.0         
## [166] viridis_0.6.2            ggtree_3.4.4             xml2_1.3.3              
## [169] admisc_0.31              boot_1.3-28.1            restfulr_0.0.15         
## [172] interp_1.1-4             geneplotter_1.74.0       bit_4.0.5               
## [175] scatterpie_0.1.9         jpeg_0.1-10              ggraph_2.1.0            
## [178] pkgconfig_2.0.3          babelgene_22.9           knitr_1.43</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
